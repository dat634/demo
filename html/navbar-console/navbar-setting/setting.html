<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>C√†i ƒë·∫∑t - H·ªçcVui</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #ff6b35;
      --bg-dark: rgb(15,23,36);
      --text: #e6eef8;
      --muted: #9aa7bf;
      --card: rgba(255,255,255,0.03);
      --shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-dark);
      color: var(--text);
      margin: 0;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* Sidebar */
    aside {
      width: 240px;
      background: rgba(255,255,255,0.03);
      border-right: 1px solid rgba(255,255,255,0.08);
      display: flex;
      flex-direction: column;
      padding: 20px 0;
    }
    .brand {
      font-weight: 800;
      font-size: 24px;
      text-align: center;
      margin-bottom: 40px;
      background: linear-gradient(135deg,var(--primary),#ffb86b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    nav {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    nav button {
      background: none;
      border: none;
      color: var(--text);
      text-align: left;
      padding: 12px 30px;
      cursor: pointer;
      transition: all .2s;
      font-weight: 500;
    }
    nav button:hover, nav button.active {
      background: rgba(255,107,53,0.2);
      border-left: 3px solid var(--primary);
    }

    /* Main */
    main {
      flex: 1;
      padding: 40px 60px;
      overflow-y: auto;
    }
    h1 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
    }
    section {
      background: var(--card);
      padding: 30px;
      border-radius: 16px;
      box-shadow: var(--shadow);
      max-width: 700px;
    }
    label {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 16px;
    }
    input, select {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 10px 12px;
      color: var(--text);
      outline: none;
    }
    input[type=color] { padding: 2px; cursor: pointer; }
    button.save {
      background: linear-gradient(90deg,var(--primary),#ffb86b);
      color: #0f1724;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 10px;
      transition: transform .1s ease;
    }
    button.save:hover { transform: scale(1.05); }

    .avatar-preview {
      min-width: 100px; min-height: 100px;
      border-radius: 50%;
      border: 2px solid var(--primary);
      object-fit: cover;
      margin-bottom: 10px;
      image-orientation: from-image;
    }

  </style>
</head>
<body>

  <aside>
    <div class="brand">H·ªçc<span>Vui</span></div>
    <nav>
      <button class="tab-btn active" data-tab="profile">üë§ H·ªì s∆°</button>
      <button class="tab-btn" data-tab="theme">üé® Giao di·ªán</button>
      <button class="tab-btn" data-tab="game">üéÆ Tr√≤ ch∆°i</button>
      <button class="tab-btn" data-tab="account">‚öôÔ∏è T√†i kho·∫£n</button>
    </nav>
  </aside>

  <main id="mainContent">
    <section id="profile" class="tab-section">
      <h1>H·ªì s∆° c√° nh√¢n</h1>
      <img id="avatarPreview" class="avatar-preview" src="#" alt="avatar">
      <label>·∫¢nh ƒë·∫°i di·ªán
        <input type="file" id="avatarInput" accept="image/*">
      </label>
      <label>T√™n hi·ªÉn th·ªã
        <input type="text" id="displayName" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n">
      </label>
      <label>Gi·ªõi thi·ªáu
        <input type="text" id="bio" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ b·∫°n...">
      </label>
      <button class="save" onclick="saveProfile()">L∆∞u thay ƒë·ªïi</button>
    </section>

    <section id="theme" class="tab-section hidden">
      <h1>T√πy ch·ªânh giao di·ªán</h1>
      <label>Ch·∫ø ƒë·ªô hi·ªÉn th·ªã
        <select id="themeMode">
          <option value="dark">T·ªëi (Dark Mode)</option>
          <option value="light">S√°ng (Light Mode)</option>
        </select>
      </label>
      <label>M√†u ch·ªß ƒë·∫°o
        <input type="color" id="themeColor" value="#ff6b35">
      </label>
      <button class="save" onclick="saveTheme()">L∆∞u giao di·ªán</button>
    </section>

    <section id="game" class="tab-section hidden">
      <h1>T√πy ch·ªânh tr√≤ ch∆°i</h1>
      <label>M·ª©c ƒë·ªô m·∫∑c ƒë·ªãnh
        <select id="defaultLevel">
          <option value="A1">A1</option>
          <option value="A2">A2</option>
          <option value="B1">B1</option>
          <option value="B2">B2</option>
          <option value="C1">C1</option>
          <option value="C2">C2</option>
        </select>
      </label>
      <label>
        <input type="checkbox" id="soundToggle" checked> B·∫≠t √¢m thanh
      </label>
      <label>
        <input type="checkbox" id="effectToggle" checked> Hi·ªáu ·ª©ng chuy·ªÉn c·∫£nh
      </label>
      <button class="save" onclick="saveGame()">L∆∞u c√†i ƒë·∫∑t</button>
    </section>

    <section id="account" class="tab-section hidden">
      <h1>T√†i kho·∫£n</h1>
      <p id="userEmail">ƒêang t·∫£i...</p>
      <button class="save" onclick="logout()">ƒêƒÉng xu·∫•t</button>
    </section>
  </main>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script>
    const avatarInput= document.getElementById('avatarInput');
    const MAXFILESIZE=2*1024*1024; // 2MB
    const firebaseConfig = {
      apiKey: "AIzaSyC_8Y5vYXvXc0kvYH0jNOziiR0t1TtStTg",
      authDomain: "myproject-7ba9f.firebaseapp.com",
      projectId: "myproject-7ba9f",
      storageBucket: "myproject-7ba9f.appspot.com",
      messagingSenderId: "614709937741",
      appId: "1:614709937741:web:d11e5325162c249cfdfe04"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    auth.onAuthStateChanged(u=>{
      if(!u) window.location.href="../login.html";
      else document.getElementById("userEmail").textContent = "ƒêƒÉng nh·∫≠p: " + u.email;
    });

    // Tab chuy·ªÉn
    document.querySelectorAll('.tab-btn').forEach(btn=>{
      btn.onclick=()=>{
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        document.querySelectorAll('.tab-section').forEach(sec=>sec.classList.add('hidden'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.remove('hidden');
      };
    });
 
    // === L∆∞u h·ªì s∆° ===
    function saveProfile(){
      const name=document.getElementById('displayName').value;
      const bio=document.getElementById('bio').value;
      localStorage.setItem('profile',{name,bio});
      alert('ƒê√£ l∆∞u h·ªì s∆°!');
    }

    // === Giao di·ªán ===
    function saveTheme(){
      const mode=document.getElementById('themeMode').value;
      const color=document.getElementById('themeColor').value;
      localStorage.setItem('theme',{mode,color});
      alert('ƒê√£ l∆∞u giao di·ªán!');
    }

    // === Game ===
    function saveGame(){
      const lvl=document.getElementById('defaultLevel').value;
      const sound=document.getElementById('soundToggle').checked;
      const fx=document.getElementById('effectToggle').checked;
      localStorage.setItem('game',{lvl,sound,fx});
      alert('ƒê√£ l∆∞u c√†i ƒë·∫∑t tr√≤ ch∆°i!');
    }

    function logout(){ auth.signOut().then(()=>location.href="../login.html"); }

    if (avatarInput = document.getElementById('avatarInput')) {
      const avatarPreview = document.getElementById('avatarPreview');
      avatarInput.addEventListener('change', function() {
        const file = this.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            avatarPreview.src = e.target.result;
          }
          reader.readAsDataURL(file);
        }
      });
    }
    if (avatarInput.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
            avatarPreview.src = e.target.result;
        }}
    avatarInput.addEventListener('change', function() {
        const file = this.files[0];
        if (file.size > MAXFILESIZE) {
            alert('K√≠ch th∆∞·ªõc t·ªáp qu√° l·ªõn! Vui l√≤ng ch·ªçn t·ªáp nh·ªè h∆°n 2MB.');
            this.value = ''; // X√≥a t·ªáp ƒë√£ ch·ªçn
            avatarPreview.src = '#'; // ƒê·∫∑t l·∫°i ·∫£nh xem tr∆∞·ªõc
            event.preventDefault(); // NgƒÉn form submit
            return;
        }});
    </script>
</body>
</html>
